(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{126:function(t,e,n){"use strict";n.r(e);var a,i,s=n(0),o=n.n(s),c=n(10),r=n.n(c),d=(n(99),n(68),n(170)),l=n(171),u=n(163),j=n(128),b=n(166),f=n(173),O=n(174),h=n(172),p=n(16),g=n(17),m=n(77),x=n.n(m).a.create(Object(g.a)({baseURL:"https://cors-anywhere.herokuapp.com/https://social-network.samuraijs.com/api/1.1/"},{withCredentials:!0,headers:{"API-KEY":"27fcbdba-1f27-4a26-aef3-5bdefc4c041f"}})),v=function(t){return x.post("auth/login",t)},k=function(){return x.delete("auth/login")},C=function(){return x.get("auth/me")},y=function(){return x.get("todo-lists")},T=function(t){return x.post("todo-lists",{title:t})},I=function(t){return x.delete("todo-lists/".concat(t))},A=function(t,e){return x.put("todo-lists/".concat(t),{title:e})},w=function(t){return x.get("todo-lists/".concat(t,"/tasks"))},S=function(t,e){return x.post("todo-lists/".concat(t,"/tasks"),{title:e})},L=function(t,e){return x.delete("todo-lists/".concat(t,"/tasks/").concat(e))},E=function(t,e,n){return x.put("todo-lists/".concat(t,"/tasks/").concat(e),n)};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(a||(a={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Mi=2]="Mi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(i||(i={}));var F=function(t,e){t.messages.length?e(B({error:t.messages[0]})):e(B({error:"Some error occurred!"})),q({status:"failed"})},P=function(t,e){e(B({error:t.message?t.message:"Some error occurred!"})),e(q({status:"failed"}))},z=n(28),M=Object(z.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{changeIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.isLoggedIn}}}),N=M.reducer,D=M.actions.changeIsLoggedInAC,R=Object(z.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatusAC:function(t,e){t.status=e.payload.status},setAppErrorAC:function(t,e){t.error=e.payload.error},setIsInitializedAC:function(t,e){t.isInitialized=e.payload.isInitialized}}}),U=R.reducer,V=R.actions,q=V.setAppStatusAC,B=V.setAppErrorAC,J=V.setIsInitializedAC,K=Object(z.b)({name:"todolists",initialState:[],reducers:{removeTodolistAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload}));-1!==n&&t.splice(n,1)},addTodolistAC:function(t,e){t.push(Object(g.a)(Object(g.a)({},e.payload),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.todolistId}));t[n].title=e.payload.newTitle},changeTodolistFilterAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.todolistId}));t[n].filter=e.payload.newFilterValue},changeTodolistEntityStatusAC:function(t,e){var n=t.findIndex((function(t){return t.id===e.payload.todolistId}));t[n].entityStatus=e.payload.status},setTodolistsAC:function(t,e){return e.payload.map((function(t){return Object(g.a)(Object(g.a)({},t),{},{filter:"all",entityStatus:"idle"})}))}}}),G=K.reducer,H=K.actions,Y=H.removeTodolistAC,_=H.addTodolistAC,Q=H.changeTodolistTitleAC,W=H.changeTodolistFilterAC,X=H.changeTodolistEntityStatusAC,Z=H.setTodolistsAC,$=Object(z.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));-1!==a&&n.splice(a,1)},addTaskAC:function(t,e){t[e.payload.todoListId].unshift(e.payload)},updateTaskAC:function(t,e){var n=t[e.payload.todolistId],a=n.findIndex((function(t){return t.id===e.payload.taskId}));-1!==a&&(n[a]=Object(g.a)(Object(g.a)({},n[a]),e.payload.properties))},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase(_,(function(t,e){t[e.payload.id]=[]})),t.addCase(Y,(function(t,e){delete t[e.payload]})),t.addCase(Z,(function(t,e){e.payload.forEach((function(e){t[e.id]=[]}))}))}}),tt=$.reducer,et=$.actions,nt=et.removeTaskAC,at=et.addTaskAC,it=et.updateTaskAC,st=et.setTasksAC,ot=function(t,e,n){return function(a,i){a(q({status:"loading"}));var s=i().tasks[n].find((function(e){return e.id===t}));if(!s)throw new Error("Task not found");var o=Object(g.a)({title:s.title,description:s.description,status:s.status,priority:s.priority,startDate:s.startDate,deadline:s.deadline},e);E(n,t,o).then((function(i){0===i.data.resultCode?(a(it({taskId:t,properties:e,todolistId:n})),a(q({status:"succeeded"}))):F(i.data,a)})).catch((function(t){P(t,a)}))}},ct=n(167),rt=n(127),dt=n(26),lt=n(164),ut=n(175),jt=n(2),bt=o.a.memo((function(t){var e=t.addItem,n=t.disabled,a=Object(s.useState)(""),i=Object(dt.a)(a,2),o=i[0],c=i[1],r=Object(s.useState)(null),d=Object(dt.a)(r,2),l=d[0],j=d[1],b=function(){""!==o.trim()?(e(o),c("")):j("Title is required!")};return Object(jt.jsx)("div",{children:Object(jt.jsxs)("div",{children:[Object(jt.jsx)(ut.a,{variant:"outlined",value:o,onChange:function(t){return c(t.currentTarget.value)},onKeyPress:function(t){l&&j(null),13===t.charCode&&b()},label:"Title",error:!!l,helperText:l}),Object(jt.jsx)(u.a,{onClick:b,color:"primary",disabled:n,children:Object(jt.jsx)(lt.a,{})})]})})}));function ft(t){var e=Object(s.useState)(!1),n=Object(dt.a)(e,2),a=n[0],i=n[1],o=Object(s.useState)(""),c=Object(dt.a)(o,2),r=c[0],d=c[1];return a?Object(jt.jsx)(ut.a,{color:"secondary",value:r,onChange:function(t){return d(t.currentTarget.value)},onBlur:function(){i(!1),t.onChange(r)},autoFocus:!0}):Object(jt.jsx)("span",{onDoubleClick:function(){i(!0),d(t.title)},children:t.title})}var Ot=n(165),ht=n(177),pt=o.a.memo((function(t){var e=t.task,n=t.removeTask,i=t.changeTaskTitle,s=t.changeTaskStatus;return Object(jt.jsxs)("li",{className:2===e.status?"done":"",children:[Object(jt.jsx)(ht.a,{checked:2===e.status,onChange:function(t){var n=t.currentTarget.checked;s(e.id,n?a.Completed:a.New)},color:"primary"}),Object(jt.jsx)(ft,{title:e.title,onChange:function(t){return i(e.id,t)}}),Object(jt.jsx)(u.a,{onClick:function(){return n(e.id)},disabled:e.status===a.InProgress,children:Object(jt.jsx)(Ot.a,{})})]},e.id)})),gt=o.a.memo((function(t){var e=Object(p.b)();Object(s.useEffect)((function(){var n;e((n=t.todolist.id,function(t){t(q({status:"loading"})),w(n).then((function(e){t(st({tasks:e.data.items,todolistId:n})),t(q({status:"succeeded"}))}))}))}),[]);var n=Object(s.useCallback)((function(e){t.addTask(e,t.todolist.id)}),[]),i=t.tasks,o=i;"active"===t.todolist.filter&&(o=i.filter((function(t){return t.status===a.New}))),"completed"===t.todolist.filter&&(o=i.filter((function(t){return t.status===a.Completed})));var c=Object(s.useCallback)((function(e){return t.removeTask(e,t.todolist.id)}),[t.removeTask,t.todolist.id]),r=Object(s.useCallback)((function(e,n){t.changeTaskStatus(e,n,t.todolist.id)}),[t.changeTaskStatus,t.todolist.id]),d=Object(s.useCallback)((function(e,n){t.changeTaskTitle(e,n,t.todolist.id)}),[t.changeTaskTitle,t.todolist.id]);return Object(jt.jsxs)("div",{children:[Object(jt.jsxs)("h3",{children:[Object(jt.jsx)(ft,{title:t.todolist.title,onChange:function(e){t.changeTodolistTitle(t.todolist.id,e)}}),Object(jt.jsx)(u.a,{onClick:function(){return t.removeTodolist(t.todolist.id)},disabled:"loading"===t.todolist.entityStatus,children:Object(jt.jsx)(Ot.a,{})})]}),Object(jt.jsx)(bt,{addItem:n,disabled:"loading"===t.todolist.entityStatus}),Object(jt.jsx)("ul",{style:{listStyle:"none",padding:"0px"},children:o.map((function(e){return Object(jt.jsx)(pt,{task:e,todolistId:t.todolist.id,removeTask:c,changeTaskStatus:r,changeTaskTitle:d},e.id)}))}),Object(jt.jsxs)("div",{children:[Object(jt.jsx)(b.a,{style:{marginRight:"10px"},size:"small",color:"primary",variant:"all"===t.todolist.filter?"outlined":"contained",onClick:function(){return t.changeFilter("all",t.todolist.id)},children:"All"}),Object(jt.jsx)(b.a,{style:{marginRight:"10px"},size:"small",color:"primary",variant:"active"===t.todolist.filter?"outlined":"contained",onClick:function(){return t.changeFilter("active",t.todolist.id)},children:"Active"}),Object(jt.jsx)(b.a,{size:"small",color:"primary",variant:"completed"===t.todolist.filter?"outlined":"contained",onClick:function(){return t.changeFilter("completed",t.todolist.id)},children:"Completed"})]})]})})),mt=n(8),xt=function(t){var e=Object(p.c)((function(t){return t.todolists})),n=Object(p.c)((function(t){return t.tasks})),i=Object(p.c)((function(t){return t.auth.isLoggedIn})),o=Object(p.b)();Object(s.useEffect)((function(){i&&o((function(t){t(q({status:"loading"})),y().then((function(e){t(Z(e.data)),t(q({status:"succeeded"}))})).catch((function(e){P(e,t)}))}))}),[]);var c=Object(s.useCallback)((function(t,e){var n=function(t,e,n){return function(a){a(it({taskId:e,properties:n,todolistId:t})),a(q({status:"loading"})),L(t,e).then((function(n){a(nt({taskId:e,todolistId:t})),a(q({status:"succeeded"}))}))}}(e,t,{status:a.InProgress});o(n)}),[o]),r=Object(s.useCallback)((function(t,e){var n=function(t,e){return function(n){n(q({status:"loading"})),S(t,e).then((function(t){0===t.data.resultCode?(n(at(t.data.data.item)),n(q({status:"succeeded"}))):F(t.data,n)})).catch((function(t){P(t,n)}))}}(e,t);o(n)}),[o]),d=Object(s.useCallback)((function(t,e,n){var a=ot(t,{status:e},n);o(a)}),[o]),l=Object(s.useCallback)((function(t,e,n){var a=ot(t,{title:e},n);o(a)}),[o]),u=Object(s.useCallback)((function(t,e){o(W({newFilterValue:t,todolistId:e}))}),[o]),j=Object(s.useCallback)((function(t,e){var n=function(t,e){return function(n){n(q({status:"loading"})),A(t,e).then((function(a){n(Q({todolistId:t,newTitle:e})),n(q({status:"succeeded"}))}))}}(t,e);o(n)}),[o]),b=Object(s.useCallback)((function(t){var e=function(t){return function(e){e(q({status:"loading"})),e(X({status:"loading",todolistId:t})),I(t).then((function(n){e(Y(t)),e(q({status:"succeeded"}))}))}}(t);o(e)}),[o]),f=Object(s.useCallback)((function(t){var e,n=(e=t,function(t){t(q({status:"loading"})),T(e).then((function(e){t(_(e.data.data.item)),t(q({status:"succeeded"}))}))});o(n)}),[o]),O=e.map((function(t){return Object(jt.jsx)(ct.a,{item:!0,children:Object(jt.jsx)(rt.a,{elevation:6,style:{padding:"20px"},children:Object(jt.jsx)(gt,{todolist:t,tasks:n[t.id],removeTask:c,addTask:r,changeTaskStatus:d,changeFilter:u,removeTodolist:b,changeTaskTitle:l,changeTodolistTitle:j})})},t.id)}));return i?Object(jt.jsxs)(jt.Fragment,{children:[Object(jt.jsx)(ct.a,{container:!0,children:Object(jt.jsx)(bt,{addItem:f})}),Object(jt.jsx)(ct.a,{container:!0,style:{paddingTop:"20px"},spacing:2,children:O})]}):Object(jt.jsx)(mt.d,{children:Object(jt.jsx)(mt.b,{path:"/",element:Object(jt.jsx)(mt.a,{to:"/login"})})})},vt=n(179),kt=n(176);function Ct(t){return Object(jt.jsx)(kt.a,Object(g.a)({elevation:6,variant:"filled"},t))}function yt(){var t=Object(p.c)((function(t){return t.app.error})),e=Object(p.b)(),n=null!==t,a=function(t,n){"clickaway"!==n&&(e(B({error:null})),e(q({status:"succeeded"})))};return Object(jt.jsx)(vt.a,{open:n,autoHideDuration:6e3,onClose:a,children:Object(jt.jsx)(Ct,{onClose:a,severity:"error",children:Object(jt.jsx)("span",{children:t})})})}var Tt=n(180),It=n(162),At=n(168),wt=n(169),St=n(84),Lt=function(){var t=Object(p.b)(),e=Object(p.c)((function(t){return t.auth.isLoggedIn})),n=Object(St.a)({validate:function(t){return t.email?t.password?void 0:{password:"Password is required!"}:{email:"Enter email!"}},initialValues:{email:"",password:"",rememberMe:!1},onSubmit:function(e){var n;t((n=e,function(t){t(q({status:"loading"})),v(n).then((function(e){0===e.data.resultCode?(t(q({status:"succeeded"})),t(D({isLoggedIn:!0}))):F(e.data,t)})).catch((function(e){P(e,t)}))}))}});return e?Object(jt.jsx)(mt.d,{children:Object(jt.jsx)(mt.b,{path:"/",element:Object(jt.jsx)(mt.a,{to:"/"})})}):Object(jt.jsx)(ct.a,{container:!0,justifyContent:"center",children:Object(jt.jsx)(ct.a,{item:!0,justifyContent:"center",children:Object(jt.jsx)("form",{onSubmit:n.handleSubmit,children:Object(jt.jsxs)(Tt.a,{children:[Object(jt.jsxs)(It.a,{children:[Object(jt.jsxs)("p",{children:["To log in get registered",Object(jt.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",children:" here"})]}),Object(jt.jsx)("p",{children:"or use common test account credentials:"}),Object(jt.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(jt.jsx)("p",{children:"Password: free"})]}),Object(jt.jsxs)(At.a,{children:[Object(jt.jsx)(ut.a,Object(g.a)({label:"Email",margin:"normal"},n.getFieldProps("email"))),n.errors.email?Object(jt.jsx)("div",{children:n.errors.email}):null,Object(jt.jsx)(ut.a,Object(g.a)({type:"password",label:"Password",margin:"normal"},n.getFieldProps("password"))),n.errors.password?Object(jt.jsx)("div",{children:n.errors.password}):null,Object(jt.jsx)(wt.a,{label:"Remember me",control:Object(jt.jsx)(ht.a,Object(g.a)(Object(g.a)({},n.getFieldProps("rememberMe")),{},{checked:n.values.rememberMe}))}),Object(jt.jsx)(b.a,{type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})})})},Et=n.p+"static/media/loader.4356ad35.svg",Ft=function(){return Object(jt.jsx)("div",{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(jt.jsx)("img",{src:Et})})};var Pt=function(){var t=Object(p.b)(),e=Object(p.c)((function(t){return t.app.status})),n=Object(p.c)((function(t){return t.app.isInitialized})),a=Object(p.c)((function(t){return t.auth.isLoggedIn})),i=Object(s.useCallback)((function(){t((function(t){t(q({status:"loading"})),k().then((function(e){0===e.data.resultCode?(t(q({status:"succeeded"})),t(D({isLoggedIn:!1}))):F(e.data,t)})).catch((function(e){P(e,t)}))}))}),[t]);return Object(s.useEffect)((function(){t((function(t){C().then((function(e){0===e.data.resultCode&&t(D({isLoggedIn:!0})),t(J({isInitialized:!0}))}))}))}),[]),n?Object(jt.jsxs)("div",{className:"App",children:[Object(jt.jsx)(yt,{}),Object(jt.jsxs)(d.a,{position:"static",children:[Object(jt.jsxs)(l.a,{style:{justifyContent:"space-between"},children:[Object(jt.jsx)(u.a,{edge:"start",color:"inherit","aria-label":"menu",children:Object(jt.jsx)(h.a,{})}),Object(jt.jsx)(j.a,{variant:"h6",children:"My trello"}),a?Object(jt.jsx)(b.a,{color:"inherit",variant:"outlined",onClick:i,children:"Log out"}):Object(jt.jsx)("div",{})]}),"loading"===e&&Object(jt.jsx)(f.a,{})]}),Object(jt.jsx)(O.a,{fixed:!0,style:{paddingTop:"20px"},children:Object(jt.jsxs)(mt.d,{children:[Object(jt.jsx)(mt.b,{path:"/",element:Object(jt.jsx)(xt,{})}),Object(jt.jsx)(mt.b,{path:"/login",element:Object(jt.jsx)(Lt,{})}),Object(jt.jsx)(mt.b,{path:"/*",element:Object(jt.jsx)("h1",{children:"404: PAGE NOT FOUND"})})]})})]}):Object(jt.jsx)(Ft,{})},zt=n(25),Mt=n(48),Nt=Object(zt.b)({tasks:tt,todolists:G,auth:N,app:U}),Dt=Object(z.a)({reducer:Nt,middleware:function(t){return t().prepend(Mt.a)}});window.store=Dt;var Rt=n(47);r.a.render(Object(jt.jsx)(p.a,{store:Dt,children:Object(jt.jsx)(Rt.a,{children:Object(jt.jsx)(Pt,{})})}),document.getElementById("root"))},68:function(t,e,n){},99:function(t,e,n){}},[[126,1,2]]]);
//# sourceMappingURL=main.1b2efd38.chunk.js.map